# ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ² SQL Server Ñ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒÑ Apache Airflow

![Apache Airflow](https://img.shields.io/badge/Apache%20Airflow-017CEE?style=for-the-badge&logo=Apache%20Airflow&logoColor=white)
![Docker](https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white)
![SQL Server](https://img.shields.io/badge/Microsoft%20SQL%20Server-CC2927?style=for-the-badge&logo=microsoft%20sql%20server&logoColor=white)

ĞŸÑ€Ğ¾ĞµĞºÑ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¸Ğ· CSV/XLSX/XLSB Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ² Microsoft SQL Server Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Apache Airflow. Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ Ğ¾Ğ±ĞµÑĞ¿ĞµÑ‡Ğ¸Ğ²Ğ°ĞµÑ‚ ÑĞºĞ²Ğ¾Ğ·Ğ½ÑƒÑ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºÑƒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¾Ñ‚ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ´Ğ¾ Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¾Ğ¹ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ñ€Ğ¾Ğ·Ğ½Ğ¸Ñ‡Ğ½Ñ‹Ñ… ÑĞµÑ‚ĞµĞ¹

## ğŸŒŸ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ² Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¸
- ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ XLSX â†’ CSV
- Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† Ğ² SQL Server
- ĞŸĞ°ĞºĞµÑ‚Ğ½Ğ°Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ¼ÑƒĞ»ÑŒÑ‚Ğ¸ÑĞµÑ‚ĞµĞ²Ğ¾Ğ¹ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· Docker-ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹

## ğŸ“¦ Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- Docker Desktop 20.10+
- Docker Compose 2.0+
- Microsoft SQL Server 2019+
- 4 Ğ“Ğ‘ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğ¹ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸

## ğŸš€ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚
1. **ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹:**
```bash
git clone https://github.com/BogdanG888G/Automatization.git
cd airflow-data-pipeline
```

2. **ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ:**
```bash
cp .env.example .env
# ĞÑ‚Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ .env Ñ„Ğ°Ğ¹Ğ» Ğ¿Ğ¾Ğ´ Ğ²Ğ°ÑˆÑƒ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
```

3. **Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚:**
```bash
docker-compose up -d --build
```

4. **Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Airflow UI:**
```
http://localhost:8080
```
Ğ›Ğ¾Ğ³Ğ¸Ğ½: `airflow`  
ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ: `airflow`

5. **ĞŸĞ¾Ğ¼ĞµÑÑ‚Ğ¸Ñ‚Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ´Ğ»Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸:**
```bash
# ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ´Ğ»Ñ Magnit
cp Ğ²Ğ°Ñˆ_Ñ„Ğ°Ğ¹Ğ».csv ./data/magnit_december_2024.csv
```

## ğŸ—‚ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
```
AUTOMATIZATION/
â”œâ”€â”€ archive/                  # ĞÑ€Ñ…Ğ¸Ğ² Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²
â”œâ”€â”€ data/                     # Ğ’Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
â”œâ”€â”€ dags/                     # Ğ˜Ğ½Ğ´Ğ¸Ğ²Ğ¸Ğ´ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğµ DAG Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ ÑĞµÑ‚Ğ¸
â”‚   â”œâ”€â”€ ashan_sales_pipeline.py
â”‚   â”œâ”€â”€ diksi_sales_pipeline.py
â”‚   â”œâ”€â”€ magnit_sales_pipeline.py
â”‚   â”œâ”€â”€ okey_sales_pipeline.py
â”‚   â”œâ”€â”€ perekrestok_sales_pipeline.py
â”‚   â”œâ”€â”€ pyaterochka_sales_pipeline.py
â”‚   â””â”€â”€ x5_sales_pipeline.py
â”œâ”€â”€ scripts/                  # Ğ¡ĞµÑ‚ĞµĞ²Ñ‹Ğµ ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡Ğ½Ñ‹Ğµ ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹
â”‚   â”œâ”€â”€ ashan/
â”‚   â”‚   â”œâ”€â”€ convert_raw_to_stage.py
â”‚   â”‚   â””â”€â”€ create_table_and_upload.py
â”‚   â”œâ”€â”€ diksi/
â”‚   â”‚   â”œâ”€â”€ convert_raw_to_stage.py
â”‚   â”‚   â””â”€â”€ create_table_and_upload.py
â”‚   â”œâ”€â”€ magnit/
â”‚   â”‚   â”œâ”€â”€ convert_raw_to_stage.py
â”‚   â”‚   â””â”€â”€ create_table_and_upload.py
â”‚   â”œâ”€â”€ okey/
â”‚   â”‚   â”œâ”€â”€ convert_raw_to_stage.py
â”‚   â”‚   â””â”€â”€ create_table_and_upload.py
â”‚   â”œâ”€â”€ perekrestok/
â”‚   â”‚   â”œâ”€â”€ convert_raw_to_stage.py
â”‚   â”‚   â””â”€â”€ create_table_and_upload.py
â”‚   â”œâ”€â”€ pyaterochka/
â”‚   â”‚   â”œâ”€â”€ convert_raw_to_stage.py
â”‚   â”‚   â””â”€â”€ create_table_and_upload.py
â”‚   â””â”€â”€ x5/
â”‚   â”‚   â”œâ”€â”€ convert_raw_to_stage.py
â”‚   â”‚   â””â”€â”€ create_table_and_upload.py
â”‚   â””â”€â”€ common/
â”‚   â”‚   â”œâ”€â”€ convert_xlsx_to_csv.py
â”‚   â”‚   â””â”€â”€ utils.py                # ĞĞ±Ñ‰Ğ¸Ğµ ÑƒÑ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹
â”œâ”€â”€ .dockerignore
â”œâ”€â”€ .env                      # ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
â”œâ”€â”€ .gitignore
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ config.py
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ TODO.md
â”œâ”€â”€ entrypoint.sh
â””â”€â”€ README.md
```

## âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğº MSSQL
1. Ğ’ Airflow UI: **Admin â†’ Variables**
2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½ÑƒÑ:
   - **Key**: `MSSQL_CONN_STR`
   - **Value**:
```
mssql+pyodbc://<user>:<password>@<host>/<database>?driver=ODBC+Driver+17+for+SQL+Server
```

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ´Ğ»Ñ Windows:
```
mssql+pyodbc://airflow_agent:Pass123@host.docker.internal/SalesDB?driver=ODBC+Driver+17+for+SQL+Server&Encrypt=yes&TrustServerCertificate=yes
```

## ğŸ”§ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ DAG
ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ DAG Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½ Ñ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ğ¼Ğ¸:
```python
with DAG(
    dag_id="retail_data_pipeline",
    start_date=datetime(2025, 1, 1),
    schedule_interval="@daily",  # Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ñ‹Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº
    catchup=False,
    tags=["retail", "data_processing"],
) as dag:
```

## Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ€Ğ¾Ğ·Ğ½Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶

### 1. ĞĞ±Ñ‰Ğ¸Ğµ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

Ğ”Ğ°Ğ½Ğ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¾ Ñ€Ğ¾Ğ·Ğ½Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ°Ñ… Ğ´Ğ»Ñ Ğ¿Ğ¾ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸. Ğ’ÑĞµ Ğ¸ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğº ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğ¼Ñƒ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñƒ.

### 2. Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹

#### 2.1. ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ñ€Ğ°Ğ·Ğ´ĞµĞ»Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

1. **Ğ˜Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ ÑĞµÑ‚Ğ¸**
2. **Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚ĞºĞ¸**
3. **Ğ“ĞµĞ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ**
4. **Ğ¢Ğ¾Ğ²Ğ°Ñ€Ğ½Ñ‹Ğµ Ñ…Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸ĞºĞ¸**
5. **Ğ˜ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²**
6. **ĞšĞ¾Ğ´Ñ‹ Ğ¸ Ğ°Ñ€Ñ‚Ğ¸ĞºÑƒĞ»Ñ‹**
7. **Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑÑ…**
8. **Ğ¤Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ²Ñ‹Ğµ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»Ğ¸**
9. **Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸**

#### 2.2. Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ĞµĞ¹

| Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ° | ĞŸĞ¾Ğ»Ğµ | Ğ¢Ğ¸Ğ¿ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ | ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ |
|--------|------|------------|----------|----------------|-----------------|
| **Ğ¡ĞµÑ‚ÑŒ** | retail_chain | NVARCHAR(50) | ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€Ğ¾Ğ·Ğ½Ğ¸Ñ‡Ğ½Ğ¾Ğ¹ ÑĞµÑ‚Ğ¸ | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 'ĞœĞ°Ğ³Ğ½Ğ¸Ñ‚' |
| **Ğ’Ñ€ĞµĞ¼Ñ** | sale_year | INT | Ğ“Ğ¾Ğ´ Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ¸ | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 2024 |
|  | sale_month | INT | ĞœĞµÑÑÑ† Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ¸ (1-12) | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 12 |
|  | sale_date | DATE | Ğ”Ğ°Ñ‚Ğ° Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ¸ (Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ¼ĞµÑÑÑ†Ğ°) | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | '2024-12-01' |
| **Ğ“ĞµĞ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ** | branch | NVARCHAR(100) | Ğ¤Ğ¸Ğ»Ğ¸Ğ°Ğ»/Ğ¾Ñ‚Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | 'Ğ¤Ğ¸Ğ»Ğ¸Ğ°Ğ» ĞŸÑ€Ğ¸Ğ²Ğ¾Ğ»Ğ¶ÑĞºĞ¸Ğ¹' |
|  | region | NVARCHAR(100) | Ğ ĞµĞ³Ğ¸Ğ¾Ğ½ | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | 'Ğ§ĞµĞ»ÑĞ±Ğ¸Ğ½ÑĞºĞ°Ñ Ğ¾Ğ±Ğ».' |
|  | city | NVARCHAR(100) | Ğ“Ğ¾Ñ€Ğ¾Ğ´ | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | 'Ğ³.Ğ§ĞµĞ»ÑĞ±Ğ¸Ğ½ÑĞº' |
|  | address | NVARCHAR(200) | ĞĞ´Ñ€ĞµÑ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ° | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 'ÑƒĞ». Ğ’Ğ¾Ñ€Ğ¾ÑˆĞ¸Ğ»Ğ¾Ğ²Ğ°, Ğ´Ğ¾Ğ¼ â„– 7' |
|  | store_format | NVARCHAR(50) | Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ° | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 'ĞœĞ”' |
|  | store_name | NVARCHAR(100) | ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ° | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 'Ğ¡ĞºÑ€ĞµĞ¿ĞºĞ°' |
| **Ğ¢Ğ¾Ğ²Ğ°Ñ€** | product_name | NVARCHAR(200) | ĞĞ°Ğ¸Ğ¼ĞµĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ° | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 'Ğ¡ĞµĞ¼ĞµÑ‡ĞºĞ¸ Ğ¾Ñ‚Ğ± Ñ Ğ¼Ğ¾Ñ€ÑĞºĞ¾Ğ¹ ÑĞ¾Ğ»ÑŒÑ' |
|  | brand | NVARCHAR(100) | Ğ‘Ñ€ĞµĞ½Ğ´ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ° | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 'ĞÑ‚ ĞœĞ°Ñ€Ñ‚Ğ¸Ğ½Ğ°' |
|  | flavor | NVARCHAR(100) | Ğ’ĞºÑƒÑ/Ğ°Ñ€Ğ¾Ğ¼Ğ°Ñ‚ | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | 'Ğ¡Ğ¾Ğ»ÑŒ ĞºĞ¾Ğ¿Ñ‡ĞµĞ½Ğ°Ñ' |
|  | weight | NVARCHAR(50) | Ğ’ĞµÑ/Ğ¾Ğ±ÑŠĞµĞ¼ | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | '200' |
|  | product_type | NVARCHAR(100) | Ğ¢Ğ¸Ğ¿ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | 'ĞŸÑ€Ğ¸ÑÑĞ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ€Ğ¸Ñ„Ğ»ĞµĞ½Ñ‹Ğµ' |
| **Ğ˜ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ** | product_level_1 | NVARCHAR(100) | Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 1 ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 'Ğ¡Ğ½ÑĞºĞ¸' |
|  | product_level_2 | NVARCHAR(100) | Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 2 ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 'Ğ¡ĞµĞ¼ĞµÑ‡ĞºĞ¸' |
|  | product_level_3 | NVARCHAR(100) | Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 3 ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 'Ğ¡ĞµĞ¼ĞµÑ‡ĞºĞ¸ Ğ¿Ğ¾Ğ´ÑĞ¾Ğ»Ğ½ĞµÑ‡Ğ½Ğ¸ĞºĞ°' |
|  | product_level_4 | NVARCHAR(100) | Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 4 ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | 'Ğ¡ĞµĞ¼ĞµÑ‡ĞºĞ¸ Ğ¿Ğ¾Ğ´ÑĞ¾Ğ»Ğ½ĞµÑ‡Ğ½Ğ¸ĞºĞ° Ğ½ĞµĞ¾Ñ‡Ğ¸Ñ‰ĞµĞ½Ğ½Ñ‹Ğµ' |
| **ĞšĞ¾Ğ´Ñ‹** | product_family_code | INT | ĞšĞ¾Ğ´ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ½Ğ¾Ğ¹ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹ | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | NULL |
|  | product_family_name | NVARCHAR(100) | ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ½Ğ¾Ğ¹ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹ | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | NULL |
|  | product_article | BIGINT | ĞÑ€Ñ‚Ğ¸ĞºÑƒĞ» Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ° | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 1000229533 |
|  | product_code | BIGINT | ĞšĞ¾Ğ´ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ° | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 1000229533 |
|  | barcode | NVARCHAR(50) | Ğ¨Ñ‚Ñ€Ğ¸Ñ…-ĞºĞ¾Ğ´ | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | '4607012351999' |
| **ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒ** | factory_code | INT | ĞšĞ¾Ğ´ Ğ·Ğ°Ğ²Ğ¾Ğ´Ğ° | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | NULL |
|  | factory_name | NVARCHAR(100) | ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ²Ğ¾Ğ´Ğ° | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | NULL |
|  | material | INT | ĞšĞ¾Ğ´ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ğ° | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | NULL |
| **ĞŸĞ¾ÑÑ‚Ğ°Ğ²Ñ‰Ğ¸ĞºĞ¸** | vendor | NVARCHAR(100) | ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒ | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | NULL |
|  | supplier | NVARCHAR(100) | ĞŸĞ¾ÑÑ‚Ğ°Ğ²Ñ‰Ğ¸Ğº | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 'ĞœĞ°Ñ€Ñ‚Ğ¸Ğ½ ĞĞĞ' |
|  | warehouse_supplier | NVARCHAR(100) | Ğ¡ĞºĞ»Ğ°Ğ´ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ñ‰Ğ¸ĞºĞ° | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | NULL |
| **Ğ¤Ğ¸Ğ½Ğ°Ğ½ÑÑ‹** | sales_quantity | INT | ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶ | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 37 |
|  | sales_amount_rub | NUMERIC(18,2) | Ğ¡ÑƒĞ¼Ğ¼Ğ° Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶ Ğ² Ñ€ÑƒĞ±Ğ»ÑÑ… | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 4879.65 |
|  | avg_cost_price | NUMERIC(18,4) | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ Ğ·Ğ°ĞºÑƒĞ¿Ğ¾Ñ‡Ğ½Ğ°Ñ Ñ†ĞµĞ½Ğ° | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 82.8660 |
|  | avg_sell_price | NUMERIC(18,4) | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ Ñ†ĞµĞ½Ğ° Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ¸ | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 131.8824 |
| **ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸** | margin_amount_rub | NUMERIC(18,2) | ĞœĞ°Ñ€Ğ¶Ğ° (Ñ€ÑƒĞ±) | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ | 1813.91 |
|  | sales_tons | NUMERIC(18,3) | ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶Ğ¸ Ğ² Ñ‚Ğ¾Ğ½Ğ½Ğ°Ñ… | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | 0.074 |
|  | sales_weight_kg | NUMERIC(18,3) | ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶Ğ¸ Ğ² ĞºĞ³ | ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ | 74.000 |

### 3. ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

#### 3.1. ĞĞ±Ñ‰Ğ¸Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°
- Ğ’ÑĞµ ÑÑ‚Ñ€Ğ¾ĞºĞ¾Ğ²Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒÑÑ Ñ‡ĞµÑ€ĞµĞ· TRY_CAST
- Ğ’ÑĞµ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ¸Ğ¼ĞµÑ‚ÑŒ ÑĞ²Ğ½Ğ¾Ğµ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸
- NULL Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ ÑĞ²Ğ½Ğ¾ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ñ‹ Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ğ¾Ğ»ĞµĞ¹

### 3.2. Ğ¡Ğ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

**Ğ”Ğ»Ñ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ° ÑÑ€ĞµĞ´Ğ½Ğ¸Ñ… Ñ†ĞµĞ½:**
```sql
TRY_CAST(
    CASE 
        WHEN TRY_CAST(revenue_qty AS NUMERIC(18,4)) > 0 
        THEN TRY_CAST(revenue_rub AS NUMERIC(18,4)) / TRY_CAST(revenue_qty AS NUMERIC(18,4))
        ELSE NULL 
    END 
AS NUMERIC(18,4)) AS avg_sell_price
```

**Ğ”Ğ»Ñ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ° Ğ¼Ğ°Ñ€Ğ¶Ğ¸:**
```sql
TRY_CAST(
    TRY_CAST(revenue_rub AS NUMERIC(18,4)) - 
    (TRY_CAST(purchase_price AS NUMERIC(18,4)) * TRY_CAST(revenue_qty AS NUMERIC(18,4)))
AS NUMERIC(18,2)) AS margin_amount_rub
```

**Ğ”Ğ»Ñ Ğ²ĞµÑĞ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ĞµĞ¹:**
```sql
-- Ğ’ Ñ‚Ğ¾Ğ½Ğ½Ğ°Ñ…
TRY_CAST(
    CASE 
        WHEN ISNUMERIC(weight_extracted) = 1 
        THEN (TRY_CAST(revenue_qty AS NUMERIC(18,3)) * TRY_CAST(weight_extracted AS NUMERIC(18,3))) / 1000 
        ELSE NULL 
    END 
AS NUMERIC(18,3)) AS sales_tons

-- Ğ’ ĞºĞ¸Ğ»Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°Ñ…
TRY_CAST(
    CASE 
        WHEN ISNUMERIC(weight_extracted) = 1 
        THEN TRY_CAST(revenue_qty AS NUMERIC(18,3)) * TRY_CAST(weight_extracted AS NUMERIC(18,3))
        ELSE NULL 
    END 
AS NUMERIC(18,3)) AS sales_weight_kg
```

### 4. ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

1. **ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ‚Ñ‹**:
   - ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ Ğ½Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ NULL Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹
   - ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ñ‹ (product_article, barcode) Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸

2. **ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ½Ğ¾ÑÑ‚Ğ¸**:
   - sales_amount_rub â‰ˆ avg_sell_price * sales_quantity
   - margin_amount_rub â‰ˆ sales_amount_rub - (avg_cost_price * sales_quantity)

3. **ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸**:
   - Ğ’ĞµÑĞ¾Ğ²Ñ‹Ğµ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»Ğ¸ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ·Ğ°ÑĞ²Ğ»ĞµĞ½Ğ½Ğ¾Ğ¼Ñƒ Ğ²ĞµÑÑƒ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°
   - Ğ”Ğ°Ñ‚Ñ‹ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑŒÑÑ Ğ² Ñ€Ğ°Ğ·ÑƒĞ¼Ğ½Ñ‹Ñ… Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… Ñ€Ğ°Ğ¼ĞºĞ°Ñ…

### 5. Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

1. Ğ”Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ [clear].[*]
2. ĞŸÑ€Ğ¸ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¸ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ product_article Ğ¸Ğ»Ğ¸ barcode Ğ² ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğµ ĞºĞ»ÑÑ‡Ğ°
3. Ğ”Ğ»Ñ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ² Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ sale_year + sale_month
4. Ğ”Ğ»Ñ Ğ³ĞµĞ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ: branch â†’ region â†’ city â†’ address



## ğŸ”„ Ğ Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ
```mermaid
graph TD
    A[Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¿ĞºĞ¸ ./data] --> B{ĞĞ°Ğ¹Ğ´ĞµĞ½ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ»?}
    B -->|Ğ”Ğ°| C[ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚ÑŒ Ñ€Ğ¾Ğ·Ğ½Ğ¸Ñ‡Ğ½ÑƒÑ ÑĞµÑ‚ÑŒ]
    B -->|ĞĞµÑ‚| Z[Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ]
    C --> D[ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ XLSX Ğ² CSV]
    D --> E[Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ Ğ² Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ¹ Ğ‘Ğ”]
    E --> F[Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² Ñ‚ĞµÑÑ‚Ğ¾Ğ²ÑƒÑ Ğ‘Ğ”]
    F --> G[ĞŸÑ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… INT, DECIMAL, NVARCHAR]
    G --> H[Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² Stage Ğ‘Ğ”]
    H --> I[ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ Ñ„Ğ°Ğ¹Ğ» Ğ² Ğ°Ñ€Ñ…Ğ¸Ğ²]
    I --> J[Ğ—Ğ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Ğ»Ğ¾Ğ³]
```

## ğŸ› Ğ£ÑÑ‚Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ½ĞµĞ¿Ğ¾Ğ»Ğ°Ğ´Ğ¾Ğº
**ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ»Ğ¾Ğ³Ğ¾Ğ²:**
```bash
docker-compose logs -f airflow-worker
```


**ĞŸĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°:**
```bash
docker-compose down --volumes --remove-orphans
docker-compose build --no-cache
docker-compose up -d
```

**ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Docker:**
```bash
docker system prune -a --volumes
```
