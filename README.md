# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ SQL Server —Å –ø–æ–º–æ—â—å—é Apache Airflow

![Apache Airflow](https://img.shields.io/badge/Apache%20Airflow-017CEE?style=for-the-badge&logo=Apache%20Airflow&logoColor=white)
![Docker](https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white)
![SQL Server](https://img.shields.io/badge/Microsoft%20SQL%20Server-CC2927?style=for-the-badge&logo=microsoft%20sql%20server&logoColor=white)

–ü—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV/XLSX/XLSB —Ñ–∞–π–ª–æ–≤ –≤ Microsoft SQL Server —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Apache Airflow. –†–µ—à–µ–Ω–∏–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–∫–≤–æ–∑–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö –æ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –¥–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö —Å–µ—Ç–µ–π

## üåü –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ SQL Server
- –ü–∞–∫–µ—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –û–±–æ–≥–∞—â–µ–Ω–∏–µ 7 —Å—Ç–æ–ª–±—Ü–æ–≤ –ø—Ä–∏ –ø–æ–º–æ—â–∏ ML
- –î–∏–Ω–∞–º–∏—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ

**–î–æ—Å—Ç—É–ø –∫ Airflow UI:**

–õ–æ–≥–∏–Ω: `airflow`  
–ü–∞—Ä–æ–ª—å: `airflow`


## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
AUTOMATIZATION/
‚îú‚îÄ‚îÄ archive/                  # –ê—Ä—Ö–∏–≤ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ data/                     # –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ dags/                     # –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ DAG –¥–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ ashan_sales_pipeline.py
‚îÇ   ‚îú‚îÄ‚îÄ diksi_sales_pipeline.py
‚îÇ   ‚îú‚îÄ‚îÄ magnit_sales_pipeline.py
‚îÇ   ‚îú‚îÄ‚îÄ okey_sales_pipeline.py
‚îÇ   ‚îú‚îÄ‚îÄ perekrestok_sales_pipeline.py
‚îÇ   ‚îú‚îÄ‚îÄ pyaterochka_sales_pipeline.py
‚îÇ   ‚îî‚îÄ‚îÄ x5_sales_pipeline.py
‚îú‚îÄ‚îÄ scripts/                  # –°–µ—Ç–µ–≤—ã–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ ashan/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ convert_raw_to_stage.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ create_table_and_upload.py
‚îÇ   ‚îú‚îÄ‚îÄ diksi/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ convert_raw_to_stage.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ create_table_and_upload.py
‚îÇ   ‚îú‚îÄ‚îÄ magnit/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ convert_raw_to_stage.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ create_table_and_upload.py
‚îÇ   ‚îú‚îÄ‚îÄ okey/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ convert_raw_to_stage.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ create_table_and_upload.py
‚îÇ   ‚îú‚îÄ‚îÄ perekrestok/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ convert_raw_to_stage.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ create_table_and_upload.py
‚îÇ   ‚îú‚îÄ‚îÄ pyaterochka/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ convert_raw_to_stage.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ create_table_and_upload.py
‚îÇ   ‚îî‚îÄ‚îÄ x5/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ convert_raw_to_stage.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ create_table_and_upload.py
‚îÇ   ‚îî‚îÄ‚îÄ common/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ convert_xlsx_to_csv.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.py                # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ .dockerignore
‚îú‚îÄ‚îÄ .env                      # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ config.py
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ TODO.md
‚îú‚îÄ‚îÄ entrypoint.sh
‚îî‚îÄ‚îÄ README.md
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂

### 1. –û–±—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è

–î–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂–∞—Ö –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏. –í—Å–µ –∏—Å—Ö–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É.

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã

#### 2.1. –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã –¥–∞–Ω–Ω—ã—Ö

1. **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–µ—Ç–∏**
2. **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏**
3. **–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ**
4. **–¢–æ–≤–∞—Ä–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**
5. **–ò–µ—Ä–∞—Ä—Ö–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤**
6. **–ö–æ–¥—ã –∏ –∞—Ä—Ç–∏–∫—É–ª—ã**
7. **–î–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è—Ö**
8. **–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏**
9. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏**

#### 2.2. –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–µ–π

| –ì—Ä—É–ø–ø–∞ | –ü–æ–ª–µ | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è |
|--------|------|------------|----------|----------------|-----------------|
| **–°–µ—Ç—å** | retail_chain | NVARCHAR(50) | –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–æ–∑–Ω–∏—á–Ω–æ–π —Å–µ—Ç–∏ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | '–ú–∞–≥–Ω–∏—Ç' |
| **–í—Ä–µ–º—è** | sale_year | INT | –ì–æ–¥ –ø—Ä–æ–¥–∞–∂–∏ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | 2024 |
|  | sale_month | INT | –ú–µ—Å—è—Ü –ø—Ä–æ–¥–∞–∂–∏ (1-12) | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | 12 |
|  | sale_date | DATE | –î–∞—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏ (–ø–µ—Ä–≤—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞) | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | '2024-12-01' |
| **–ì–µ–æ–≥—Ä–∞—Ñ–∏—è** | branch | NVARCHAR(100) | –§–∏–ª–∏–∞–ª/–æ—Ç–¥–µ–ª–µ–Ω–∏–µ | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | '–§–∏–ª–∏–∞–ª –ü—Ä–∏–≤–æ–ª–∂—Å–∫–∏–π' |
|  | region | NVARCHAR(100) | –†–µ–≥–∏–æ–Ω | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | '–ß–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª.' |
|  | city | NVARCHAR(100) | –ì–æ—Ä–æ–¥ | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | '–≥.–ß–µ–ª—è–±–∏–Ω—Å–∫' |
|  | address | NVARCHAR(200) | –ê–¥—Ä–µ—Å –º–∞–≥–∞–∑–∏–Ω–∞ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | '—É–ª. –í–æ—Ä–æ—à–∏–ª–æ–≤–∞, –¥–æ–º ‚Ññ 7' |
|  | store_format | NVARCHAR(50) | –§–æ—Ä–º–∞—Ç –º–∞–≥–∞–∑–∏–Ω–∞ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | '–ú–î' |
|  | store_name | NVARCHAR(100) | –ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | '–°–∫—Ä–µ–ø–∫–∞' |
| **–¢–æ–≤–∞—Ä** | product_name | NVARCHAR(200) | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | '–°–µ–º–µ—á–∫–∏ –æ—Ç–± —Å –º–æ—Ä—Å–∫–æ–π —Å–æ–ª—å—é' |
|  | brand | NVARCHAR(100) | –ë—Ä–µ–Ω–¥ —Ç–æ–≤–∞—Ä–∞ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | '–û—Ç –ú–∞—Ä—Ç–∏–Ω–∞' |
|  | flavor | NVARCHAR(100) | –í–∫—É—Å/–∞—Ä–æ–º–∞—Ç | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | '–°–æ–ª—å –∫–æ–ø—á–µ–Ω–∞—è' |
|  | weight | NVARCHAR(50) | –í–µ—Å/–æ–±—ä–µ–º | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | '200' |
|  | product_type | NVARCHAR(100) | –¢–∏–ø –ø—Ä–æ–¥—É–∫—Ç–∞ | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | '–ü—Ä–∏—Å—Å–æ–≤–∞–Ω–Ω—ã–µ —Ä–∏—Ñ–ª–µ–Ω—ã–µ' |
| **–ò–µ—Ä–∞—Ä—Ö–∏—è** | product_level_1 | NVARCHAR(100) | –£—Ä–æ–≤–µ–Ω—å 1 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | '–°–Ω—ç–∫–∏' |
|  | product_level_2 | NVARCHAR(100) | –£—Ä–æ–≤–µ–Ω—å 2 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | '–°–µ–º–µ—á–∫–∏' |
|  | product_level_3 | NVARCHAR(100) | –£—Ä–æ–≤–µ–Ω—å 3 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | '–°–µ–º–µ—á–∫–∏ –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫–∞' |
|  | product_level_4 | NVARCHAR(100) | –£—Ä–æ–≤–µ–Ω—å 4 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | '–°–µ–º–µ—á–∫–∏ –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫–∞ –Ω–µ–æ—á–∏—â–µ–Ω–Ω—ã–µ' |
| **–ö–æ–¥—ã** | product_family_code | INT | –ö–æ–¥ —Ç–æ–≤–∞—Ä–Ω–æ–π –≥—Ä—É–ø–ø—ã | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | NULL |
|  | product_family_name | NVARCHAR(100) | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–Ω–æ–π –≥—Ä—É–ø–ø—ã | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | NULL |
|  | product_article | BIGINT | –ê—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | 1000229533 |
|  | product_code | BIGINT | –ö–æ–¥ —Ç–æ–≤–∞—Ä–∞ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | 1000229533 |
|  | barcode | NVARCHAR(50) | –®—Ç—Ä–∏—Ö-–∫–æ–¥ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | '4607012351999' |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å** | factory_code | INT | –ö–æ–¥ –∑–∞–≤–æ–¥–∞ | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | NULL |
|  | factory_name | NVARCHAR(100) | –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–≤–æ–¥–∞ | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | NULL |
|  | material | INT | –ö–æ–¥ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | NULL |
| **–ü–æ—Å—Ç–∞–≤—â–∏–∫–∏** | vendor | NVARCHAR(100) | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | NULL |
|  | supplier | NVARCHAR(100) | –ü–æ—Å—Ç–∞–≤—â–∏–∫ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | '–ú–∞—Ä—Ç–∏–Ω –û–û–û' |
|  | warehouse_supplier | NVARCHAR(100) | –°–∫–ª–∞–¥ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | NULL |
| **–§–∏–Ω–∞–Ω—Å—ã** | sales_quantity | INT | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–∂ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | 37 |
|  | sales_amount_rub | NUMERIC(18,2) | –°—É–º–º–∞ –ø—Ä–æ–¥–∞–∂ –≤ —Ä—É–±–ª—è—Ö | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | 4879.65 |
|  | avg_cost_price | NUMERIC(18,4) | –°—Ä–µ–¥–Ω—è—è –∑–∞–∫—É–ø–æ—á–Ω–∞—è —Ü–µ–Ω–∞ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | 82.8660 |
|  | avg_sell_price | NUMERIC(18,4) | –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | 131.8824 |
| **–ú–µ—Ç—Ä–∏–∫–∏** | margin_amount_rub | NUMERIC(18,2) | –ú–∞—Ä–∂–∞ (—Ä—É–±) | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | 1813.91 |
|  | sales_tons | NUMERIC(18,3) | –ü—Ä–æ–¥–∞–∂–∏ –≤ —Ç–æ–Ω–Ω–∞—Ö | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | 0.074 |
|  | sales_weight_kg | NUMERIC(18,3) | –ü—Ä–æ–¥–∞–∂–∏ –≤ –∫–≥ | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | 74.000 |

### 4. –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ—Ç—ã**:
   - –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –Ω–µ –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å NULL –∑–Ω–∞—á–µ–Ω–∏–π
   - –ö–ª—é—á–µ–≤—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã (product_article, barcode) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏**:
   - sales_amount_rub ‚âà avg_sell_price * sales_quantity
   - margin_amount_rub ‚âà sales_amount_rub - (avg_cost_price * sales_quantity)

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏**:
   - –í–µ—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∑–∞—è–≤–ª–µ–Ω–Ω–æ–º—É –≤–µ—Å—É –ø—Ä–æ–¥—É–∫—Ç–∞
   - –î–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ä–∞–∑—É–º–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–∞–º–∫–∞—Ö

### 5. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

1. –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è [clear].[*]
2. –ü—Ä–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å product_article –∏–ª–∏ barcode –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–∞
3. –î–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–Ω–∞–ª–∏–∑–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—é sale_year + sale_month
4. –î–ª—è –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é: branch ‚Üí region ‚Üí city ‚Üí address



## üîÑ –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å
```mermaid
graph TD
    A[–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏ ./data] --> B{–ù–∞–π–¥–µ–Ω –Ω–æ–≤—ã–π —Ñ–∞–π–ª?}
    B -->|–î–∞| C[–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–æ–∑–Ω–∏—á–Ω—É—é —Å–µ—Ç—å]
    B -->|–ù–µ—Ç| Z[–ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å]
    C --> D[–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å XLSX –≤ CSV]
    D --> E[–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î]
    E --> F[–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ç–µ—Å—Ç–æ–≤—É—é –ë–î]
    F --> G[–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö INT, DECIMAL, NVARCHAR]
    G --> H[–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Stage –ë–î]
    H --> I[–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª –≤ –∞—Ä—Ö–∏–≤]
    I --> J[–ó–∞–ø–∏—Å–∞—Ç—å —É—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ –ª–æ–≥]
```
